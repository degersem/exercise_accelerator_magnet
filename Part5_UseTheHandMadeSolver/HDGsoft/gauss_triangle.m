function [weights,localcds]=gauss_triangle(p)

% function [weights,localcds]=gauss_triangle(p)
% returns the weights and local coordinates for Gauss quadrature on a reference triangle
%
% D.A. Dunavant "High-degree efficient symmetrical Gaussian quadrature rules for the triangle",
% Int. J. Numer. Methods Eng., Vol. 21, No. 6, 1985, pp. 1129-1148.
%
% input parameters
%    p                : order (between 1 and 6)
%
% output parameters
%    weights          : N-by-1 vector of weights
%    localcds         : N-by-3 vector of local coordinates
%                     : xi ; eta ; 1-xi-eta are local coordinate in the triangle (ranging from 0 to 1)
%
% usage for calculating the integral of function "ft" on a triangle with area "area_triangle"
%    integral = area_triangle * sum_i weights(i)*f(xi(i),eta(i),1-xi(i)-eta(i))
%
% (c) This software is intended for didactical purposes. It comes without any warranty.
%     It may not be used for commercial purposes without notice to the authors.
%     It may be distributed freely in the KU Leuven, TU Darmstadt, TU Graz, Univ. Lille 1,
%     BU Wuppertal and RWTH Aachen. Any copy should include this message.

switch p
  case 1
    weights=1;
    localcds=[ 1/3 1/3 1/3 ];
  case 2
    weights=[ 1/3 1/3 1/3 ];
    localcds=[
      2/3 1/6 1/6 ;
      1/6 2/3 1/6 ;
      1/6 1/6 2/3 ;
      ];
  case 3
    weights=[ -0.5625 0.5208333333333333333333333333333 0.5208333333333333333333333333333 0.5208333333333333333333333333333 ];
    localcds=[
      1/3 1/3 1/3 ;
      3/5 1/5 1/5 ;
      1/5 3/5 1/5 ;
      1/5 1/5 3/5 ;
      ];
  case 4
    weights=[ 0.109951743655322 0.109951743655322 0.109951743655322 0.223381589678011 0.223381589678011 0.223381589678011 ];
    localcds=[
      0.816847572980459 0.091576213509771 0.091576213509771 ;
      0.091576213509771 0.816847572980459 0.091576213509771 ;
      0.091576213509771 0.091576213509771 0.816847572980459 ;
      0.108103018168070 0.445948490915965 0.445948490915965 ;
      0.445948490915965 0.108103018168070 0.445948490915965 ;
      0.445948490915965 0.445948490915965 0.108103018168070 ;
      ];
  case 5
    weights=[ 0.225000000000000 0.125939180544827 0.125939180544827 0.125939180544827 0.132394152788506 0.132394152788506 0.132394152788506 ];
    localcds=[
      0.333333333333333 0.333333333333333 0.333333333333333 ;
      0.797426985353087 0.101286507323456 0.101286507323456 ;
      0.101286507323456 0.797426985353087 0.101286507323456 ;
      0.101286507323456 0.101286507323456 0.797426985353087 ;
      0.059715871789770 0.470142064105115 0.470142064105115 ;
      0.470142064105115 0.059715871789770 0.470142064105115 ;
      0.470142064105115 0.470142064105115 0.059715871789770 ;
      ];
  case 6
    weights=[ 0.050844906370207 0.050844906370207 0.050844906370207 0.116786275726379 0.116786275726379 0.116786275726379 0.082851075618374 0.082851075618374 0.082851075618374 0.082851075618374 0.082851075618374 0.082851075618374 ];
    localcds=[
      0.873821971016996 0.063089014491502 0.063089014491502 ;
      0.063089014491502 0.873821971016996 0.063089014491502 ;
      0.063089014491502 0.063089014491502 0.873821971016996 ;
      0.501426509658179 0.249286745170910 0.249286745170910 ;
      0.249286745170910 0.501426509658179 0.249286745170910 ;
      0.249286745170910 0.249286745170910 0.501426509658179 ;
      0.636502499121399 0.310352451033785 0.053145049844816 ;
      0.310352451033785 0.636502499121399 0.053145049844816 ;
      0.310352451033785 0.053145049844816 0.636502499121399 ;
      0.636502499121399 0.053145049844816 0.310352451033785 ;
      0.053145049844816 0.636502499121399 0.310352451033785 ;
      0.053145049844816 0.310352451033785 0.636502499121399 ;
      ];
  case 7
    weights=[ -0.149570044467670 0.175615257433204 0.175615257433204 0.175615257433204 0.053347235608839 0.053347235608839 0.053347235608839 0.077113760890257 0.077113760890257 0.077113760890257 0.077113760890257 0.077113760890257 0.077113760890257 ];
    localcds=[
      0.333333333333333 0.333333333333333 0.333333333333333 ;
      0.479308067841923 0.260345966079038 0.260345966079038 ;
      0.260345966079038 0.479308067841923 0.260345966079038 ;
      0.260345966079038 0.260345966079038 0.479308067841923 ;
      0.869739794195568 0.065130102902216 0.065130102902216 ;
      0.065130102902216 0.869739794195568 0.065130102902216 ;
      0.065130102902216 0.065130102902216 0.869739794195568 ;
      0.638444188569809 0.312865496004875 0.048690315425316 ;
      0.312865496004875 0.638444188569809 0.048690315425316 ;
      0.312865496004875 0.048690315425316 0.638444188569809 ;
      0.638444188569809 0.048690315425316 0.312865496004875 ;
      0.048690315425316 0.638444188569809 0.312865496004875 ;
      0.048690315425316 0.312865496004875 0.638444188569809 ;
      ];
  otherwise
    error('Gauss quadrature on triangles with accuracy order %d unknown\n',p);
end
